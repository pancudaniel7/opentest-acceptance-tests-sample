description: Verify if the pulsar broker sending and receiving messeges works
actors:
  - actor: PULSAR
    segments:
      - segment: 1
        actions:
          - description: Create the pulsar producer
            action: com.raiffeisen.opentest.pulsarium.CreateProducers
            args:
              producers:
                - producerName: producer1
                  topicName: topic1
                  schema: string
          - description: Sent messages to the broker
            action: com.raiffeisen.opentest.pulsarium.SendMessages
            args:
              producerName: producer1
              messages: [ 'message-one', 'message-two', 'message-three' ]
          - description: Create pulsar consumer
            action: com.raiffeisen.opentest.pulsarium.CreateConsumers
            args:
              consumers:
                - topicNames: [ 'topic1' ]
                  subscriptionName: topic1-subscription
                  consumerName: consumer1
                  schema: string
          - description: Consume messages from broker
            action: com.raiffeisen.opentest.pulsarium.ConsumeMessages
            args:
              consumerName: consumer1
              consumingStopLength: 3
              $localData:
                consumedMessages: $output.consumedMessages
          - script: |
              $log(" ---> Messages consumed:" + $localData.consumedMessages);

